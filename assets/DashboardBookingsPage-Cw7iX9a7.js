import{j as e}from"./particles-CSzCUO-v.js";import{b as r,L as b}from"./vendor-BFu755QE.js";import{b as j}from"./bookingService-Cehkg5m9.js";import{c as f,D as v}from"./index-BzGNHlk_.js";import{u as $}from"./useAuth-D526BSg0.js";const B=({userRole:t="member",showFilters:i=!0,roomId:n})=>{const{theme:N}=f(),a=v[N],[c,k]=r.useState([]),[y,d]=r.useState(!0),[m,u]=r.useState(null),[l,x]=r.useState({status:"",roomId:n||""});r.useEffect(()=>{o()},[l]);const o=async()=>{try{d(!0);const s=await j.getBookings(l.roomId||void 0,l.status||void 0);k(s),u(null)}catch(s){u("Gagal memuat daftar booking"),console.error("Error fetching bookings:",s)}finally{d(!1)}},w=s=>{const g={pending:{className:a.badges.warning,label:"Menunggu"},approved:{className:a.badges.success,label:"Disetujui"},rejected:{className:a.badges.danger,label:"Ditolak"},cancelled:{className:a.badges.info,label:"Dibatalkan"}}[s];return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${g.className}`,children:g.label})},h=s=>new Date(s).toLocaleString("id-ID",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),M=async s=>{if(confirm("Apakah Anda yakin ingin membatalkan booking ini?"))try{await j.cancelBooking(s),o()}catch(p){console.error("Error cancelling booking:",p),alert("Gagal membatalkan booking")}};return y?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-blue"})}):m?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-red-400 mb-4",children:m}),e.jsx("button",{onClick:o,className:"px-4 py-2 bg-accent-blue text-white rounded hover:bg-blue-600 transition-colors",children:"Coba Lagi"})]}):c.length===0?e.jsxs("div",{className:"text-center py-12 text-soft-gray",children:[e.jsx("div",{className:"text-xl mb-2",children:"Belum ada booking"}),e.jsx("p",{className:"text-sm",children:"Booking ruangan akan muncul di sini."})]}):e.jsxs("div",{className:"space-y-6",children:[i&&e.jsxs("div",{className:`${a.panel.bg} ${a.panel.border} rounded-lg p-6`,children:[e.jsx("h3",{className:`text-lg font-semibold ${a.panel.text} mb-4`,children:"Filter"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${a.panel.textMuted} mb-2`,children:"Status"}),e.jsxs("select",{value:l.status,onChange:s=>x({...l,status:s.target.value}),className:`w-full px-4 py-2 ${a.input} rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue`,children:[e.jsx("option",{value:"",children:"Semua Status"}),e.jsx("option",{value:"pending",children:"Menunggu"}),e.jsx("option",{value:"approved",children:"Disetujui"}),e.jsx("option",{value:"rejected",children:"Ditolak"}),e.jsx("option",{value:"cancelled",children:"Dibatalkan"})]})]}),t==="admin"&&e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${a.panel.textMuted} mb-2`,children:"ID Ruangan"}),e.jsx("input",{type:"text",value:l.roomId,onChange:s=>x({...l,roomId:s.target.value}),placeholder:"Masukkan ID ruangan",className:`w-full px-4 py-2 ${a.input} rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue`})]})]})]}),e.jsx("div",{className:"space-y-4",children:c.map(s=>e.jsx("div",{className:`${a.panel.bg} ${a.panel.border} rounded-lg p-6 hover:shadow-md transition-all duration-300`,children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`text-lg font-semibold ${a.panel.text} mb-2`,children:s.title}),e.jsxs("div",{className:`grid md:grid-cols-2 gap-2 text-sm ${a.panel.textMuted}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-accent-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Ruangan: ",s.room_name||s.room_id]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-accent-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),t==="admin"?`User: ${s.user_username}`:"Booking Anda"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-accent-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),h(s.start_time)]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-accent-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),h(s.end_time)]})]}),s.description&&e.jsx("p",{className:`mt-3 text-sm ${a.panel.textMuted}`,children:s.description})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-3 mt-4 md:mt-0 md:ml-6",children:[w(s.status),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(b,{to:`/dashboard/bookings/${s.id}`,className:`px-3 py-1 text-sm ${a.buttons.ghost} rounded transition-colors`,children:"Detail"}),(t==="admin"||s.status==="pending")&&e.jsx("button",{onClick:()=>M(s.id),className:`px-3 py-1 text-sm ${a.buttons.danger} rounded transition-colors`,children:"Batalkan"})]})]})]})},s.id))})]})},H=()=>{const{user:t}=$(),{theme:i}=f(),n=v[i];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[e.jsxs("div",{className:"mb-4 md:mb-0",children:[e.jsx("h2",{className:`text-xl font-semibold mb-2 ${n.panel.text}`,children:"Manajemen Booking"}),e.jsx("p",{className:`text-sm ${n.panel.textMuted}`,children:"Kelola dan pantau status booking ruangan"})]}),e.jsx("div",{className:"flex space-x-3",children:e.jsx(b,{to:"/dashboard/bookings/new",className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${n.buttons.primary}`,children:"+ Booking Baru"})})]}),e.jsx("div",{className:`${n.panel.bg} ${n.panel.border} rounded-lg p-6 backdrop-blur-sm shadow-sm`,children:e.jsx(B,{userRole:t==null?void 0:t.role})})]})};export{H as default};
