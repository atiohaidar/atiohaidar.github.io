import{u as l}from"./useQuery-CnrhNLmL.js";import{b as Q,d as r}from"./index-BzGNHlk_.js";import{u as M}from"./useMutation-D7kuVVOc.js";import{f as b,h as D,u as w,i as R,t as A,j as B,k as _,m as x,n as I,o as H,p as W,q as z,r as G,v as J}from"./services-BaVGtfnM.js";import{s as N,b as O,r as V,d as X}from"./apiClient-0gU9eKXL.js";import{b as Y}from"./vendor-BFu755QE.js";function i(e){var U;const{showLoader:o,updateLoader:u}=Q(),c=Y.useRef(0),{loader:s,onMutate:f,onSuccess:q,onError:k,...C}=e;let T="http://localhost:8787";(U=s==null?void 0:s.endpoint)!=null&&U.startsWith("http")&&(T=s.endpoint);const h=new URL(T),F=h.host,K=h.protocol==="https:";return M({...C,onMutate:async a=>{if(s&&(c.current=performance.now(),o({title:s.title,subtitle:s.subtitle,successMessage:s.successMessage,endpoint:s.endpoint||"-",method:s.method||"-",serverHost:F,isSecure:K,completeDelay:800})),f)return await f(a)},onSuccess:(a,y,m,...g)=>{if(s){const d=Math.round(performance.now()-c.current),p=(a==null?void 0:a.__status)||"-";u({status:"success",actualLatency:d,actualStatusCode:p,successMessage:s.successMessage||"Operation successful"})}q&&q(a,y,m,...g)},onError:(a,y,m,...g)=>{var d,p,S,v;if(s){const E=Math.round(performance.now()-c.current),t=a,L=((p=(d=t==null?void 0:t.response)==null?void 0:d.data)==null?void 0:p.message)||((S=t==null?void 0:t.data)==null?void 0:S.message)||(a instanceof Error?a.message:"Operation failed"),P=(t==null?void 0:t.status)||((v=t==null?void 0:t.response)==null?void 0:v.status)||500;u({status:"error",actualLatency:E,actualStatusCode:P,errorMessage:L})}k&&k(a,y,m,...g)}})}const n={users:["users"],tasks:["tasks"],tickets:["tickets"],events:["events"],stats:["stats"]},ne=()=>M({mutationFn:b,onSuccess:e=>{N(e.token),O(e.user)}}),ae=()=>{const e=r();return()=>{V(),X(),e.clear()}},ue=()=>l({queryKey:n.users,queryFn:I}),re=e=>l({queryKey:["users",e],queryFn:()=>H.get(e),enabled:!!e}),oe=()=>{const e=r();return i({mutationFn:D,loader:{title:"Creating User",subtitle:"Registering new account",successMessage:"User created successfully",endpoint:"/api/users",method:"POST"},onSuccess:()=>{e.invalidateQueries({queryKey:n.users})}})},ce=()=>{const e=r();return i({mutationFn:({username:o,updates:u})=>w(o,u),loader:{title:"Updating User",subtitle:"Saving changes",successMessage:"Profile updated successfully",endpoint:"/api/users/:username",method:"PUT"},onSuccess:()=>{e.invalidateQueries({queryKey:n.users})}})},ie=()=>{const e=r();return i({mutationFn:R,loader:{title:"Deleting User",subtitle:"Removing account permanently",successMessage:"User deleted",endpoint:"/api/users/:username",method:"DELETE"},onSuccess:()=>{e.invalidateQueries({queryKey:n.users})}})},le=()=>{const e=r();return i({mutationFn:({toUsername:o,amount:u,description:c})=>A(o,u,c),loader:{title:"Transferring Funds",subtitle:"Processing secure transaction",successMessage:"Transfer successful",endpoint:"/api/users/transfer",method:"POST"},onSuccess:()=>{e.invalidateQueries({queryKey:n.users})}})},de=()=>{const e=r();return i({mutationFn:({targetUsername:o,amount:u,description:c})=>B(o,u,c),loader:{title:"Processing Top Up",subtitle:"Adding funds to account",successMessage:"Top up successful",endpoint:"/api/users/topup",method:"POST"},onSuccess:()=>{e.invalidateQueries({queryKey:n.users})}})},pe=e=>l({queryKey:[...n.tasks,e],queryFn:()=>W(e)}),ye=()=>{const e=r();return i({mutationFn:_,loader:{title:"Creating Task",subtitle:"Adding to your list",successMessage:"Task created",endpoint:"/api/tasks",method:"POST"},onSuccess:()=>{e.invalidateQueries({queryKey:n.tasks})}})},me=()=>{const e=r();return i({mutationFn:x,loader:{title:"Deleting Task",subtitle:"Removing item",successMessage:"Task deleted",endpoint:"/api/tasks/:id",method:"DELETE"},onSuccess:()=>{e.invalidateQueries({queryKey:n.tasks})}})},ge=e=>l({queryKey:[...n.tickets,e],queryFn:()=>z(e)}),fe=()=>l({queryKey:n.events,queryFn:G}),qe=()=>l({queryKey:n.stats,queryFn:J,refetchInterval:6e4});export{ae as a,le as b,de as c,re as d,qe as e,ge as f,fe as g,pe as h,ye as i,me as j,ue as k,oe as l,ce as m,ie as n,ne as u};
