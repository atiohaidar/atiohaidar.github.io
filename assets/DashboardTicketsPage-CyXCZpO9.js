import{j as e}from"./particles-CSzCUO-v.js";import{u as _,b as r}from"./vendor-BFu755QE.js";import{q as g,l as k,K as A}from"./services-BaVGtfnM.js";import{C as t}from"./index-BzGNHlk_.js";import{a as Y}from"./apiClient-0gU9eKXL.js";const M=()=>{const d=_(),[o,u]=r.useState([]),[h,b]=r.useState([]),[l,p]=r.useState(null),[R,i]=r.useState(!0),[m,c]=r.useState(null),[a,x]=r.useState({status:"",categoryId:"",searchQuery:""}),[D,N]=r.useState(null);r.useEffect(()=>{const s=Y();s&&N(s),T()},[]);const T=async()=>{i(!0),c(null);try{const[s,n,v]=await Promise.all([g(),k(),A()]);u(s),b(n),p(v)}catch(s){c(s instanceof Error?s.message:"Failed to load tickets")}finally{i(!1)}},j=async()=>{i(!0);try{const s={};a.status&&(s.status=a.status),a.categoryId&&(s.categoryId=Number(a.categoryId)),a.searchQuery&&(s.searchQuery=a.searchQuery);const n=await g(s);u(n)}catch(s){c(s instanceof Error?s.message:"Failed to filter tickets")}finally{i(!1)}},f=s=>{switch(s){case"open":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100";case"in_progress":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100";case"waiting":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-100";case"solved":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-100"}},y=s=>{switch(s){case"open":return"Terbuka";case"in_progress":return"Dalam Proses";case"waiting":return"Menunggu";case"solved":return"Selesai";default:return s}},E=s=>{switch(s){case"low":return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-100";case"medium":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100";case"high":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-100";case"critical":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-100";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-100"}},$=s=>{switch(s){case"low":return"Rendah";case"medium":return"Sedang";case"high":return"Tinggi";case"critical":return"Kritis";default:return s}};return R&&!o.length?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:`text-center ${t.TEXT_PRIMARY}`,children:"Memuat tiket..."})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:`text-3xl font-bold ${t.TEXT_PRIMARY}`,children:"Manajemen Tiket"}),e.jsx("button",{onClick:()=>d("/dashboard"),className:`px-4 py-2 rounded-lg ${t.BG_SECONDARY} ${t.TEXT_PRIMARY} hover:opacity-80 transition-opacity`,children:"← Kembali ke Dashboard"})]}),m&&e.jsx("div",{className:"mb-6 p-4 rounded-lg bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-100",children:m}),l&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:`${t.BG_SECONDARY} rounded-lg p-4 text-center border ${t.BORDER}`,children:[e.jsx("div",{className:`text-3xl font-bold ${t.TEXT_PRIMARY}`,children:l.total}),e.jsx("div",{className:`text-sm ${t.TEXT_SECONDARY}`,children:"Total"})]}),e.jsxs("div",{className:`${t.BG_SECONDARY} rounded-lg p-4 text-center border ${t.BORDER}`,children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:l.open}),e.jsx("div",{className:`text-sm ${t.TEXT_SECONDARY}`,children:"Terbuka"})]}),e.jsxs("div",{className:`${t.BG_SECONDARY} rounded-lg p-4 text-center border ${t.BORDER}`,children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:l.in_progress}),e.jsx("div",{className:`text-sm ${t.TEXT_SECONDARY}`,children:"Proses"})]}),e.jsxs("div",{className:`${t.BG_SECONDARY} rounded-lg p-4 text-center border ${t.BORDER}`,children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:l.waiting}),e.jsx("div",{className:`text-sm ${t.TEXT_SECONDARY}`,children:"Menunggu"})]}),e.jsxs("div",{className:`${t.BG_SECONDARY} rounded-lg p-4 text-center border ${t.BORDER}`,children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:l.solved}),e.jsx("div",{className:`text-sm ${t.TEXT_SECONDARY}`,children:"Selesai"})]})]}),e.jsxs("div",{className:`${t.BG_SECONDARY} rounded-lg p-6 mb-6 border ${t.BORDER}`,children:[e.jsx("h2",{className:`text-xl font-bold ${t.TEXT_PRIMARY} mb-4`,children:"Filter"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block ${t.TEXT_PRIMARY} mb-2 text-sm font-medium`,children:"Status"}),e.jsxs("select",{value:a.status,onChange:s=>x({...a,status:s.target.value}),className:`w-full px-4 py-2 rounded-lg ${t.BG_PRIMARY} ${t.TEXT_PRIMARY} border ${t.BORDER} focus:outline-none focus:ring-2 focus:ring-accent-blue`,children:[e.jsx("option",{value:"",children:"Semua Status"}),e.jsx("option",{value:"open",children:"Terbuka"}),e.jsx("option",{value:"in_progress",children:"Dalam Proses"}),e.jsx("option",{value:"waiting",children:"Menunggu"}),e.jsx("option",{value:"solved",children:"Selesai"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block ${t.TEXT_PRIMARY} mb-2 text-sm font-medium`,children:"Kategori"}),e.jsxs("select",{value:a.categoryId,onChange:s=>x({...a,categoryId:s.target.value}),className:`w-full px-4 py-2 rounded-lg ${t.BG_PRIMARY} ${t.TEXT_PRIMARY} border ${t.BORDER} focus:outline-none focus:ring-2 focus:ring-accent-blue`,children:[e.jsx("option",{value:"",children:"Semua Kategori"}),h.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block ${t.TEXT_PRIMARY} mb-2 text-sm font-medium`,children:"Pencarian"}),e.jsx("input",{type:"text",value:a.searchQuery,onChange:s=>x({...a,searchQuery:s.target.value}),placeholder:"Cari tiket...",className:`w-full px-4 py-2 rounded-lg ${t.BG_PRIMARY} ${t.TEXT_PRIMARY} border ${t.BORDER} focus:outline-none focus:ring-2 focus:ring-accent-blue`})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:j,className:`px-6 py-2 rounded-lg ${t.BUTTON_PRIMARY} ${t.TEXT_ON_ACCENT} hover:opacity-90 transition-opacity`,children:"Terapkan Filter"})})]}),e.jsx("div",{className:`${t.BG_SECONDARY} rounded-lg border ${t.BORDER}`,children:o.length===0?e.jsx("div",{className:`p-8 text-center ${t.TEXT_SECONDARY}`,children:"Tidak ada tiket ditemukan"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:`${t.BG_PRIMARY} border-b ${t.BORDER}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3 text-left text-sm font-semibold ${t.TEXT_PRIMARY}`,children:"Token"}),e.jsx("th",{className:`px-6 py-3 text-left text-sm font-semibold ${t.TEXT_PRIMARY}`,children:"Judul"}),e.jsx("th",{className:`px-6 py-3 text-left text-sm font-semibold ${t.TEXT_PRIMARY}`,children:"Kategori"}),e.jsx("th",{className:`px-6 py-3 text-left text-sm font-semibold ${t.TEXT_PRIMARY}`,children:"Status"}),e.jsx("th",{className:`px-6 py-3 text-left text-sm font-semibold ${t.TEXT_PRIMARY}`,children:"Prioritas"}),e.jsx("th",{className:`px-6 py-3 text-left text-sm font-semibold ${t.TEXT_PRIMARY}`,children:"Ditangani"}),e.jsx("th",{className:`px-6 py-3 text-left text-sm font-semibold ${t.TEXT_PRIMARY}`,children:"Aksi"})]})}),e.jsx("tbody",{children:o.map(s=>e.jsxs("tr",{className:`border-b ${t.BORDER} hover:bg-gray-50 dark:hover:bg-white/5 cursor-pointer transition-colors`,onClick:()=>d(`/dashboard/tickets/${s.id}`),children:[e.jsx("td",{className:`px-6 py-4 text-sm ${t.TEXT_PRIMARY} font-mono`,children:s.token}),e.jsx("td",{className:`px-6 py-4 text-sm ${t.TEXT_PRIMARY}`,children:s.title}),e.jsx("td",{className:`px-6 py-4 text-sm ${t.TEXT_SECONDARY}`,children:s.category_name}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${f(s.status)}`,children:y(s.status)})}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${E(s.priority)}`,children:$(s.priority)})}),e.jsx("td",{className:`px-6 py-4 text-sm ${t.TEXT_SECONDARY}`,children:s.assigned_to||"-"}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsx("button",{onClick:n=>{n.stopPropagation(),d(`/dashboard/tickets/${s.id}`)},className:`${t.TEXT_ACCENT} hover:underline`,children:"Detail →"})})]},s.id))})]})})})]})};export{M as default};
