import{j as e}from"./particles-CSzCUO-v.js";import{b as m}from"./vendor-BFu755QE.js";import{k as C,l as M,m as k,n as D}from"./useApi-aMnoPUty.js";import{c as y,D as N}from"./index-BzGNHlk_.js";import"./useQuery-CnrhNLmL.js";import"./useMutation-D7kuVVOc.js";import"./services-BaVGtfnM.js";import"./apiClient-0gU9eKXL.js";const S=()=>{var j;const{data:r,isLoading:i,error:x}=C(),l=M(),h=k(),g=D(),{theme:w}=y(),s=N[w],[p,b]=m.useState(!1),[v,u]=m.useState(null),[t,d]=m.useState({username:"",name:"",password:"",role:"member"}),[o,c]=m.useState({name:"",password:""}),f=async a=>{a.preventDefault();try{await l.mutateAsync(t),d({username:"",name:"",password:"",role:"member"}),b(!1)}catch{}},$=async a=>{try{await h.mutateAsync({username:a,updates:o}),u(null),c({name:"",password:""})}catch{}},U=async a=>{if(window.confirm(`Are you sure you want to delete user "${a}"?`))try{await g.mutateAsync(a)}catch{}};return i?e.jsx("div",{className:`text-center py-8 ${s.panel.textMuted}`,children:"Loading users..."}):x?e.jsx("div",{className:"p-4 rounded-lg border border-status-danger/40 bg-status-danger-muted",children:e.jsx("p",{className:"text-status-danger-dark",children:x.message})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:`text-xl font-bold ${s.panel.text}`,children:"Users Management"}),e.jsx("button",{onClick:()=>b(!p),className:`px-4 py-2 rounded-lg font-semibold transition-colors ${s.buttons.info}`,children:p?"Cancel":"Create User"})]}),p&&e.jsxs("form",{onSubmit:f,className:`${s.panel.bg} ${s.panel.border} ${s.panel.text} p-6 rounded-lg space-y-4`,children:[e.jsx("h4",{className:`text-lg font-semibold ${s.panel.text}`,children:"Create New User"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Username",value:t.username,onChange:a=>d({...t,username:a.target.value}),className:`px-4 py-2 rounded-lg ${s.input}`,required:!0}),e.jsx("input",{type:"text",placeholder:"Name",value:t.name,onChange:a=>d({...t,name:a.target.value}),className:`px-4 py-2 rounded-lg ${s.input}`,required:!0}),e.jsx("input",{type:"password",placeholder:"Password",value:t.password,onChange:a=>d({...t,password:a.target.value}),className:`px-4 py-2 rounded-lg ${s.input}`,required:!0}),e.jsxs("select",{value:t.role,onChange:a=>d({...t,role:a.target.value}),className:`px-4 py-2 rounded-lg ${s.input}`,children:[e.jsx("option",{value:"member",children:"Member"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsx("button",{type:"submit",disabled:l.isPending,className:`px-6 py-2 rounded-lg font-semibold transition-colors ${s.buttons.success} disabled:opacity-50 disabled:cursor-not-allowed`,children:l.isPending?"Creating...":"Create User"}),l.isError&&e.jsx("p",{className:"text-sm text-status-danger-dark",children:(j=l.error)==null?void 0:j.message})]}),e.jsx("div",{className:"space-y-3",children:r==null?void 0:r.map(a=>e.jsx("div",{className:`${s.panel.bg} ${s.panel.border} ${s.panel.text} p-4 rounded-lg`,children:v===a.username?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",placeholder:"New name",value:o.name,onChange:n=>c({...o,name:n.target.value}),className:`px-3 py-2 rounded ${s.input}`}),e.jsx("input",{type:"password",placeholder:"New password",value:o.password,onChange:n=>c({...o,password:n.target.value}),className:`px-3 py-2 rounded ${s.input}`})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>$(a.username),disabled:h.isPending,className:`px-4 py-2 rounded transition-colors ${s.buttons.success} disabled:opacity-50 disabled:cursor-not-allowed`,children:"Save"}),e.jsx("button",{onClick:()=>{u(null),c({name:"",password:""})},className:`px-4 py-2 rounded transition-colors ${s.buttons.secondary}`,children:"Cancel"})]})]}):e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:`font-semibold ${s.panel.text}`,children:a.name}),e.jsxs("p",{className:`text-sm ${s.panel.textMuted}`,children:["@",a.username," â€¢ ",a.role]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u(a.username),className:`px-3 py-1 text-sm rounded transition-colors ${s.buttons.info}`,children:"Edit"}),e.jsx("button",{onClick:()=>U(a.username),disabled:g.isPending,className:`px-3 py-1 text-sm rounded transition-colors ${s.buttons.danger} disabled:opacity-50 disabled:cursor-not-allowed`,children:"Delete"})]})]})},a.username))})]})},T=()=>{const{theme:r}=y(),i=N[r];return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:`text-xl font-semibold mb-2 ${i.panel.text}`,children:"Manajemen Pengguna"}),e.jsx("p",{className:`text-sm ${i.panel.textMuted}`,children:"Kelola pengguna aplikasi (hanya untuk admin)"})]}),e.jsx(S,{})]})};export{T as default};
