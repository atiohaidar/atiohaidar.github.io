import{j as e}from"./particles-CSzCUO-v.js";import{u as q,i as O,b as r}from"./vendor-BFu755QE.js";import{r as W}from"./roomService-DyUIZVgF.js";import{b as F}from"./bookingService-Cehkg5m9.js";import{b as H,c as U,D as z}from"./index-BzGNHlk_.js";const G=()=>{const u=q(),[R]=O(),m=R.get("roomId"),{showLoader:M,updateLoader:h}=H(),{theme:D}=U(),t=z[D],[p,B]=r.useState([]),[b,f]=r.useState(!1),[L,j]=r.useState(!0),[k,i]=r.useState(null),C="http://localhost:8787",v=new URL(C),T=v.host,A=v.protocol==="https:",[s,y]=r.useState({room_id:m||"",title:"",description:"",start_time:"",end_time:""});r.useEffect(()=>{P()},[]);const P=async()=>{try{j(!0);const a=await W.getRooms(!0);B(a),m&&!a.find(o=>o.id===m)&&y(o=>({...o,room_id:""})),i(null)}catch(a){i("Gagal memuat daftar ruangan"),console.error("Error fetching rooms:",a)}finally{j(!1)}},E=async a=>{var w,$,S;if(a.preventDefault(),!s.room_id||!s.title||!s.start_time||!s.end_time){i("Semua field wajib diisi");return}const o=new Date(s.start_time),g=new Date(s.end_time);if(o>=g){i("Waktu selesai harus setelah waktu mulai");return}if(o<=new Date){i("Waktu mulai harus di masa depan");return}f(!0),i(null);const d=performance.now();M({title:"Submitting Booking",subtitle:"Requesting room reservation",endpoint:"/api/bookings",method:"POST",serverHost:T,isSecure:A,completeDelay:800});try{const n=await F.createBooking(s),x=Math.round(performance.now()-d);h({status:"success",actualLatency:x,actualStatusCode:201,successMessage:"Booking submitted successfully"}),u(`/dashboard/bookings/${n.id}`,{state:{message:"Booking berhasil dibuat!"}})}catch(n){f(!1);const x=Math.round(performance.now()-d),_=(($=(w=n==null?void 0:n.response)==null?void 0:w.data)==null?void 0:$.message)||(n==null?void 0:n.message)||"Gagal membuat booking";h({status:"error",actualLatency:x,actualStatusCode:((S=n==null?void 0:n.response)==null?void 0:S.status)||500,errorMessage:_}),i(_)}},l=a=>{const{name:o,value:g}=a.target;y(d=>({...d,[o]:g}))},N=()=>{const a=new Date;return a.setMinutes(a.getMinutes()-a.getTimezoneOffset()),a.toISOString().slice(0,16)},I=()=>p.find(a=>a.id===s.room_id);if(L)return e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-blue"})});const c=I();return e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:`text-3xl font-bold ${t.panel.text} mb-2`,children:"Booking Ruangan"}),e.jsx("p",{className:t.panel.textMuted,children:"Isi formulir berikut untuk memesan ruangan"})]}),e.jsxs("div",{className:`${t.panel.bg} ${t.panel.border} rounded-lg p-8 backdrop-blur-sm shadow-sm`,children:[k&&e.jsx("div",{className:`mb-6 p-4 ${t.badges.danger} rounded-lg`,children:e.jsx("div",{className:"text-sm",children:k})}),p.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:`${t.panel.textMuted} mb-4`,children:"Tidak ada ruangan tersedia untuk booking"}),e.jsx("button",{onClick:()=>u("/dashboard/rooms"),className:`px-4 py-2 ${t.buttons.primary} rounded transition-colors`,children:"Lihat Ruangan"})]}):e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t.panel.text} mb-2`,children:"Pilih Ruangan *"}),e.jsxs("select",{name:"room_id",value:s.room_id,onChange:l,required:!0,className:`w-full px-4 py-3 ${t.input} rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue`,children:[e.jsx("option",{value:"",children:"-- Pilih Ruangan --"}),p.map(a=>e.jsxs("option",{value:a.id,children:[a.name," (Kapasitas: ",a.capacity,")"]},a.id))]}),c&&e.jsx("div",{className:`mt-3 p-3 ${t.surface} rounded-lg ${t.panel.border} border`,children:e.jsxs("div",{className:`text-sm ${t.panel.textMuted}`,children:[e.jsx("div",{className:`font-medium ${t.panel.text} mb-1`,children:"Informasi Ruangan:"}),e.jsxs("div",{children:["Kapasitas: ",c.capacity," orang"]}),c.description&&e.jsx("div",{className:"mt-1",children:c.description})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t.panel.text} mb-2`,children:"Judul Booking *"}),e.jsx("input",{type:"text",name:"title",value:s.title,onChange:l,required:!0,maxLength:100,className:`w-full px-4 py-3 ${t.input} rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue`,placeholder:"Contoh: Meeting Tim Development"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t.panel.text} mb-2`,children:"Deskripsi"}),e.jsx("textarea",{name:"description",value:s.description,onChange:l,rows:3,maxLength:500,className:`w-full px-4 py-3 ${t.input} rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue resize-vertical`,placeholder:"Agenda atau informasi tambahan tentang booking"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t.panel.text} mb-2`,children:"Waktu Mulai *"}),e.jsx("input",{type:"datetime-local",name:"start_time",value:s.start_time,onChange:l,required:!0,min:N(),className:`w-full px-4 py-3 ${t.input} rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t.panel.text} mb-2`,children:"Waktu Selesai *"}),e.jsx("input",{type:"datetime-local",name:"end_time",value:s.end_time,onChange:l,required:!0,min:s.start_time||N(),className:`w-full px-4 py-3 ${t.input} rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue`})]}),e.jsx("div",{className:`p-4 ${t.badges.info} rounded-lg`,children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium mb-1",children:"ℹ️ Informasi:"}),e.jsxs("ul",{className:"space-y-1 text-xs opacity-90",children:[e.jsx("li",{children:'• Booking akan diajukan dalam status "Menunggu Persetujuan"'}),e.jsx("li",{children:"• Admin akan memreview dan menyetujui booking Anda"}),e.jsx("li",{children:"• Anda dapat membatalkan booking sewaktu-waktu"}),e.jsx("li",{children:"• Pastikan waktu booking tidak bentrok dengan booking lain"})]})]})}),e.jsxs("div",{className:"flex space-x-4 pt-6",children:[e.jsx("button",{type:"submit",disabled:b,className:`flex-1 px-6 py-3 ${t.buttons.primary} rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors`,children:b?"Memproses...":"Ajukan Booking"}),e.jsx("button",{type:"button",onClick:()=>u("/dashboard/rooms"),className:`flex-1 px-6 py-3 ${t.buttons.ghost} rounded-lg transition-colors`,children:"Batal"})]})]})]})]})},Y=()=>e.jsx("div",{children:e.jsx(G,{})});export{Y as default};
