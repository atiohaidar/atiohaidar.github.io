import{j as e}from"./particles-CSzCUO-v.js";import{b as l,L as C}from"./vendor-BFu755QE.js";import{c as E,D as B}from"./index-BzGNHlk_.js";import{G as m}from"./services-BaVGtfnM.js";import{a as D}from"./apiClient-0gU9eKXL.js";const T=()=>{const{theme:j}=E(),t=B[j],r=D(),f=(r==null?void 0:r.role)==="admin",N=a=>f||a.owner_username===(r==null?void 0:r.username),[p,k]=l.useState([]),[y,b]=l.useState(!0),[h,g]=l.useState(null),[v,c]=l.useState(!1),[$,o]=l.useState(!1),[x,u]=l.useState(null),[s,n]=l.useState({name:"",description:"",stock:1,attachment_link:""});l.useEffect(()=>{d()},[]);const d=async()=>{try{b(!0),g(null);const a=await m.list();k(a)}catch(a){g(a.message||"Gagal memuat daftar barang")}finally{b(!1)}},w=async a=>{a.preventDefault();try{await m.create(s),c(!1),n({name:"",description:"",stock:1,attachment_link:""}),d()}catch(i){alert(i.message||"Gagal menambahkan barang")}},S=async a=>{if(a.preventDefault(),!!x)try{await m.update(x.id,s),o(!1),u(null),n({name:"",description:"",stock:1,attachment_link:""}),d()}catch(i){alert(i.message||"Gagal memperbarui barang")}},_=async a=>{if(confirm("Apakah Anda yakin ingin menghapus barang ini?"))try{await m.delete(a),d()}catch(i){alert(i.message||"Gagal menghapus barang")}},M=a=>{u(a),n({name:a.name,description:a.description||"",stock:a.stock,attachment_link:a.attachment_link||""}),o(!0)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[e.jsxs("div",{className:"mb-4 md:mb-0",children:[e.jsx("h2",{className:`text-xl font-semibold mb-2 ${t.panel.text}`,children:"Manajemen Barang"}),e.jsx("p",{className:`text-sm ${t.panel.textMuted}`,children:"Kelola barang yang dapat dipinjam"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>c(!0),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${t.buttons.info}`,children:"+ Tambah Barang"}),e.jsx(C,{to:"/dashboard/item-borrowings",className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${t.buttons.primary}`,children:"Lihat Peminjaman"})]})]}),e.jsx("div",{className:`${t.panel.bg} ${t.panel.border} rounded-lg p-6`,children:y?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:t.panel.textMuted,children:"Memuat..."})}):h?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-red-500",children:h})}):p.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:t.panel.textMuted,children:"Belum ada barang"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(a=>e.jsxs("div",{className:`${t.panel.bg} ${t.panel.border} rounded-lg p-4`,children:[e.jsx("h3",{className:`font-semibold mb-2 ${t.panel.text}`,children:a.name}),a.description&&e.jsx("p",{className:`text-sm mb-2 ${t.panel.textMuted}`,children:a.description}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-sm ${t.panel.textMuted}`,children:"Stok:"}),e.jsx("span",{className:`text-sm font-medium ${t.panel.text}`,children:a.stock})]}),a.attachment_link&&e.jsx("a",{href:a.attachment_link,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-500 hover:underline mb-2 block",children:"Lihat Lampiran"}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("span",{className:`text-xs ${t.panel.textMuted}`,children:["Pemilik: ",a.owner_username]}),N(a)&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>M(a),className:`px-3 py-1 text-xs rounded ${t.buttons.info}`,children:"Edit"}),e.jsx("button",{onClick:()=>_(a.id),className:"px-3 py-1 text-xs rounded bg-red-500 text-white hover:bg-red-600",children:"Hapus"})]})]})]},a.id))})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:`${t.panel.bg} rounded-lg p-6 max-w-md w-full mx-4`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${t.panel.text}`,children:"Tambah Barang Baru"}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t.panel.text}`,children:"Nama Barang *"}),e.jsx("input",{type:"text",value:s.name,onChange:a=>n({...s,name:a.target.value}),className:`w-full px-3 py-2 border rounded-lg ${t.input}`,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t.panel.text}`,children:"Deskripsi"}),e.jsx("textarea",{value:s.description,onChange:a=>n({...s,description:a.target.value}),className:`w-full px-3 py-2 border rounded-lg ${t.input}`,rows:3})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t.panel.text}`,children:"Stok *"}),e.jsx("input",{type:"number",min:"1",value:s.stock,onChange:a=>n({...s,stock:parseInt(a.target.value,10)}),className:`w-full px-3 py-2 border rounded-lg ${t.input}`,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t.panel.text}`,children:"Link Lampiran"}),e.jsx("input",{type:"url",value:s.attachment_link,onChange:a=>n({...s,attachment_link:a.target.value}),className:`w-full px-3 py-2 border rounded-lg ${t.input}`,placeholder:"https://example.com/manual.pdf"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>{c(!1),n({name:"",description:"",stock:1,attachment_link:""})},className:`px-4 py-2 text-sm rounded-lg ${t.buttons.secondary}`,children:"Batal"}),e.jsx("button",{type:"submit",className:`px-4 py-2 text-sm rounded-lg ${t.buttons.primary}`,children:"Simpan"})]})]})]})}),$&&x&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:`${t.panel.bg} rounded-lg p-6 max-w-md w-full mx-4`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${t.panel.text}`,children:"Edit Barang"}),e.jsxs("form",{onSubmit:S,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t.panel.text}`,children:"Nama Barang *"}),e.jsx("input",{type:"text",value:s.name,onChange:a=>n({...s,name:a.target.value}),className:`w-full px-3 py-2 border rounded-lg ${t.input}`,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t.panel.text}`,children:"Deskripsi"}),e.jsx("textarea",{value:s.description,onChange:a=>n({...s,description:a.target.value}),className:`w-full px-3 py-2 border rounded-lg ${t.input}`,rows:3})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t.panel.text}`,children:"Stok *"}),e.jsx("input",{type:"number",min:"1",value:s.stock,onChange:a=>n({...s,stock:parseInt(a.target.value,10)}),className:`w-full px-3 py-2 border rounded-lg ${t.input}`,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t.panel.text}`,children:"Link Lampiran"}),e.jsx("input",{type:"url",value:s.attachment_link,onChange:a=>n({...s,attachment_link:a.target.value}),className:`w-full px-3 py-2 border rounded-lg ${t.input}`,placeholder:"https://example.com/manual.pdf"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>{o(!1),u(null),n({name:"",description:"",stock:1,attachment_link:""})},className:`px-4 py-2 text-sm rounded-lg ${t.buttons.secondary}`,children:"Batal"}),e.jsx("button",{type:"submit",className:`px-4 py-2 text-sm rounded-lg ${t.buttons.primary}`,children:"Simpan"})]})]})]})})]})};export{T as default};
