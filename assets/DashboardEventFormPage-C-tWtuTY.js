import{j as e}from"./particles-CSzCUO-v.js";import{u as j,h as T,b as p}from"./vendor-BFu755QE.js";import{u as A}from"./useQuery-CnrhNLmL.js";import{d as $,C as a}from"./index-BzGNHlk_.js";import{u as f}from"./useMutation-D7kuVVOc.js";import{R as y,S as D,T as C}from"./services-BaVGtfnM.js";const S=()=>{const o=j(),{eventId:d}=T(),m=$(),s=!!d,[r,x]=p.useState({title:"",description:"",event_date:"",location:""}),[n,c]=p.useState({}),{data:l,isLoading:E}=A({queryKey:["event",d],queryFn:()=>C(d),enabled:s});p.useEffect(()=>{l&&s&&x({title:l.title,description:l.description||"",event_date:l.event_date,location:l.location||""})},[l,s]);const h=f({mutationFn:y,onSuccess:t=>{m.invalidateQueries({queryKey:["events"]}),o(`/dashboard/events/${t.id}`)},onError:t=>{c({submit:t.message||"Gagal membuat acara"})}}),v=f({mutationFn:t=>D(d,t),onSuccess:t=>{m.invalidateQueries({queryKey:["events"]}),m.invalidateQueries({queryKey:["event",d]}),o(`/dashboard/events/${t.id}`)},onError:t=>{c({submit:t.message||"Gagal memperbarui acara"})}}),N=()=>{const t={};return r.title.trim()||(t.title="Judul acara harus diisi"),r.event_date?new Date(r.event_date)<new Date&&!s&&(t.event_date="Tanggal acara tidak boleh di masa lalu"):t.event_date="Tanggal dan waktu acara harus diisi",c(t),Object.keys(t).length===0},_=async t=>{t.preventDefault(),N()&&(s?v.mutate(r):h.mutate(r))},u=(t,R)=>{x(b=>({...b,[t]:R})),n[t]&&c(b=>{const g={...b};return delete g[t],g})};if(s&&E)return e.jsx("div",{className:`min-h-screen ${a.BG_PRIMARY} p-6`,children:e.jsxs("div",{className:`${a.BG_SECONDARY} p-8 rounded-lg border ${a.BORDER} text-center`,children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-blue mx-auto mb-4"}),e.jsx("p",{className:a.TEXT_SECONDARY,children:"Memuat data acara..."})]})});const i=h.isPending||v.isPending;return e.jsx("div",{className:`min-h-screen ${a.BG_PRIMARY} p-6`,children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("button",{onClick:()=>o("/dashboard/events"),className:`${a.TEXT_SECONDARY} hover:${a.TEXT_PRIMARY} mb-4 flex items-center`,children:"â† Kembali ke Daftar Acara"}),e.jsx("h1",{className:`text-3xl font-bold ${a.TEXT_PRIMARY} mb-2`,children:s?"Edit Acara":"Buat Acara Baru"}),e.jsx("p",{className:a.TEXT_SECONDARY,children:s?"Perbarui informasi acara":"Buat acara dan kelola pendaftaran peserta"})]}),e.jsxs("form",{onSubmit:_,className:`${a.BG_SECONDARY} p-6 rounded-lg border ${a.BORDER}`,children:[n.submit&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-red-600 dark:text-red-400",children:n.submit})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{htmlFor:"title",className:`block mb-2 font-medium ${a.TEXT_PRIMARY}`,children:["Judul Acara ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"title",type:"text",value:r.title,onChange:t=>u("title",t.target.value),className:`w-full px-4 py-3 rounded-lg border ${n.title?"border-red-500":a.BORDER} ${a.BG_PRIMARY} ${a.TEXT_PRIMARY} focus:outline-none focus:ring-2 focus:ring-accent-blue`,placeholder:"Contoh: Workshop Web Development",disabled:i}),n.title&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:n.title})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"description",className:`block mb-2 font-medium ${a.TEXT_PRIMARY}`,children:"Deskripsi"}),e.jsx("textarea",{id:"description",value:r.description,onChange:t=>u("description",t.target.value),rows:4,className:`w-full px-4 py-3 rounded-lg border ${a.BORDER} ${a.BG_PRIMARY} ${a.TEXT_PRIMARY} focus:outline-none focus:ring-2 focus:ring-accent-blue`,placeholder:"Jelaskan tentang acara ini...",disabled:i})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{htmlFor:"event_date",className:`block mb-2 font-medium ${a.TEXT_PRIMARY}`,children:["Tanggal dan Waktu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"event_date",type:"datetime-local",value:r.event_date?new Date(r.event_date).toISOString().slice(0,16):"",onChange:t=>u("event_date",t.target.value?new Date(t.target.value).toISOString():""),className:`w-full px-4 py-3 rounded-lg border ${n.event_date?"border-red-500":a.BORDER} ${a.BG_PRIMARY} ${a.TEXT_PRIMARY} focus:outline-none focus:ring-2 focus:ring-accent-blue`,disabled:i}),n.event_date&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:n.event_date})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"location",className:`block mb-2 font-medium ${a.TEXT_PRIMARY}`,children:"Lokasi"}),e.jsx("input",{id:"location",type:"text",value:r.location,onChange:t=>u("location",t.target.value),className:`w-full px-4 py-3 rounded-lg border ${a.BORDER} ${a.BG_PRIMARY} ${a.TEXT_PRIMARY} focus:outline-none focus:ring-2 focus:ring-accent-blue`,placeholder:"Contoh: Auditorium Utama",disabled:i})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:()=>o("/dashboard/events"),className:`px-6 py-3 ${a.BG_PRIMARY} ${a.TEXT_SECONDARY} rounded-lg hover:${a.BG_HOVER} transition-colors border ${a.BORDER}`,disabled:i,children:"Batal"}),e.jsx("button",{type:"submit",className:`flex-1 px-6 py-3 ${a.BG_ACCENT} ${a.TEXT_ACCENT_CONTRAST} rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed`,disabled:i,children:i?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("span",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),s?"Memperbarui...":"Membuat..."]}):s?"Perbarui Acara":"Buat Acara"})]})]})]})})};export{S as default};
